<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VS Bomber.js - game.ts</title>
    <style>
        :root { --bg-editor: #1f1f1f; --bg-sidebar: #181818; --bg-activity: #2b2d2e; --bg-statusbar: #007acc; --bg-title: #3c3c3c; --border: #2b2b2b; --text: #cccccc; --blue: #569cd6; --green: #6a9955; --orange: #ce9178; --purple: #c586c0; --yellow: #dcdcaa; --red: #f14c4c; --toast-bg: #252526; }
        body { margin: 0; padding: 0; background-color: var(--bg-editor); color: var(--text); font-family: 'Consolas', 'Fira Code', monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        #title-bar { height: 30px; background: var(--bg-title); display: flex; align-items: center; justify-content: center; font-size: 12px; color: #999; }
        #main-layout { flex: 1; display: flex; overflow: hidden; }
        #activity-bar { width: 48px; background: var(--bg-activity); display: flex; flex-direction: column; align-items: center; padding-top: 10px; }
        .icon { width: 24px; height: 24px; margin-bottom: 20px; opacity: 0.6; cursor: pointer; filter: grayscale(100%); }
        .icon.active { opacity: 1; border-left: 2px solid white; filter: none; }
        
        #sidebar { width: 240px; background: var(--bg-sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-title { padding: 10px; font-size: 11px; font-weight: bold; text-transform: uppercase; display: flex; justify-content: space-between; cursor: pointer; background: #252526; margin-top: 1px; }
        .sidebar-content { flex: 1; overflow-y: auto; font-size: 13px; }
        
        #editor-group { flex: 1; display: flex; flex-direction: column; background: var(--bg-editor); }
        
        #tabs { height: 35px; background: #2d2d2d; display: flex; align-items: center; }
        .tab { background: var(--bg-editor); padding: 8px 15px; font-size: 13px; color: #fff; border-top: 2px solid var(--blue); display: flex; align-items: center; cursor: pointer; }
        
        #editor-container { flex: 1; position: relative; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        #gutter { width: 40px; text-align: right; padding-right: 15px; color: #6e7681; font-size: 13px; line-height: 50px; padding-top: 15px; }
        
        canvas { box-shadow: 0 0 20px rgba(0,0,0,0.5); background: var(--bg-editor); }
        
        #terminal-panel { height: 180px; border-top: 1px solid var(--border); background: var(--bg-editor); display: flex; flex-direction: column; }
        #terminal-tabs { padding: 5px 20px; font-size: 11px; border-bottom: 1px solid var(--border); color: #999; display: flex; gap: 20px; }
        .term-tab.active { color: white; text-decoration: underline; text-decoration-color: var(--orange); text-underline-offset: 4px; }
        #chat-history { flex: 1; overflow-y: auto; padding: 10px; font-size: 12px; font-family: 'Consolas', monospace; }
        #chat-input-line { display: flex; align-items: center; padding: 5px 10px; background: var(--bg-editor); display: none; }
        #chat-input { background: transparent; border: none; color: #fff; font-family: inherit; flex: 1; outline: none; }
        .prompt { color: var(--blue); margin-right: 8px; }
        
        .modal { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #252526; padding: 25px; border: 1px solid #454545; box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 999; text-align: center; width: 350px; }
        #game-over { display: none; border-top: 3px solid var(--red); }
        input.login-input { background: #3c3c3c; border: 1px solid #3c3c3c; color: white; padding: 8px; width: 100%; box-sizing: border-box; margin: 10px 0; font-family: inherit; }
        input.login-input:focus { border-color: var(--blue); outline: none; }
        button.btn-primary { background: var(--bg-statusbar); color: white; border: none; padding: 8px 16px; cursor: pointer; width: 100%; font-family: inherit; }
        button.btn-primary:hover { opacity: 0.9; }
        button.btn-danger { background: var(--red); }
        #status-bar { height: 22px; background: var(--bg-statusbar); color: white; font-size: 12px; display: flex; align-items: center; padding: 0 10px; justify-content: space-between; }
        
        #toast-container { position: absolute; bottom: 20px; right: 20px; width: 350px; display: flex; flex-direction: column; gap: 10px; z-index: 10000; pointer-events: none; }
        .vscode-toast { background-color: var(--toast-bg); color: #cccccc; padding: 10px 15px; box-shadow: 0 0 10px rgba(0,0,0,0.5); font-size: 13px; display: flex; gap: 12px; animation: slideIn 0.3s cubic-bezier(0.23, 1, 0.32, 1); pointer-events: auto; border: 1px solid #303031; align-items: flex-start; }
        .vscode-toast.error { border-left: 3px solid var(--red); }
        .vscode-toast.info { border-left: 3px solid var(--blue); }
        .vscode-toast.warn { border-left: 3px solid var(--orange); }
        .toast-icon { font-size: 16px; margin-top: -2px; }
        .toast-content { flex: 1; display: flex; flex-direction: column; gap: 4px; }
        .toast-title { font-weight: 600; color: white; }
        .toast-msg { color: #cccccc; line-height: 1.4; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 13px; }
        .toast-close { cursor: pointer; color: #888; font-size: 14px; }
        .toast-close:hover { color: #fff; }

        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOut { to { opacity: 0; transform: translateY(10px); } }

        ::-webkit-scrollbar { width: 10px; height: 10px; }
        ::-webkit-scrollbar-thumb { background: #424242; }
        ::-webkit-scrollbar-track { background: var(--bg-editor); }

        /* ESTILO DOS SLIDERS (VOLUME E ZOOM) */
        #bgm-volume::-webkit-slider-runnable-track, #zoom-slider::-webkit-slider-runnable-track { background: #3c3c3c; height: 3px; }
        #bgm-volume::-webkit-slider-thumb, #zoom-slider::-webkit-slider-thumb { appearance: none; width: 10px; height: 10px; background: #007acc; border-radius: 50%; margin-top: -3.5px; transition: transform 0.1s; }
        #bgm-volume:hover::-webkit-slider-thumb, #zoom-slider:hover::-webkit-slider-thumb { transform: scale(1.2); }

        /* --- ESTILO DA COLUNA DIREITA (ACTIVITY LOG) --- */
        #right-sidebar { width: 250px; background: var(--bg-sidebar); border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        .log-container { flex: 1; overflow-y: auto; padding: 5px; font-size: 11px; font-family: 'Consolas', monospace; }
        .log-entry { margin-bottom: 4px; padding: 4px 6px; border-left: 2px solid transparent; background: #252526; word-break: break-word; animation: slideIn 0.2s ease-out; }
        .log-entry .time { color: #858585; margin-right: 5px; font-size: 10px; }
    </style>
</head>
<body>
    <div id="title-bar">game.js - VS Bomber - Visual Studio Code</div>
    <div id="main-layout">
        
        <div id="activity-bar">
            <div class="icon active" style="background: #fff; mask: url('https://api.iconify.design/codicon:files.svg') no-repeat center; -webkit-mask: url('https://api.iconify.design/codicon:files.svg') no-repeat center;"></div>
            <div class="icon" style="background: #fff; mask: url('https://api.iconify.design/codicon:search.svg') no-repeat center; -webkit-mask: url('https://api.iconify.design/codicon:search.svg') no-repeat center;"></div>
        </div>

        <div id="sidebar">
            <div class="sidebar-title"><span>OPEN EDITORS</span> <span>...</span></div>
            <div class="sidebar-content" style="height: auto; padding: 5px;">
                <div style="padding: 2px 10px; background: #37373d; color: #fff; margin-bottom: 2px;">
                    <span style="color: #e8ba36">JS</span> game.js
                </div>
                <div id="sound-toggle-btn" onclick="toggleSoundMode()" style="padding: 2px 10px; color: #858585; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                    <span id="sound-icon" style="color: #6a9955">OFF</span>
                    <span id="sound-filename">sound_modern.js</span>
                </div>
                <div id="volume-control" style="padding: 5px 10px; margin-top: 5px; border-top: 1px solid #2b2b2b;">
                    <div style="font-size: 10px; color: #666; margin-bottom: 5px; font-family: Consolas;">// volume_config.json</div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 10px; color: #858585;">VOL</span>
                        <input type="range" id="bgm-volume" min="0" max="1" step="0.01" value="0.30" 
                               oninput="updateVolume(this.value)"
                               style="flex: 1; cursor: pointer; accent-color: #007acc; height: 3px; background: #3c3c3c; border-radius: 2px; appearance: none;">
                    </div>
                </div>
                <div id="zoom-control" style="padding: 5px 10px; margin-top: 5px; border-top: 1px solid #2b2b2b;">
                    <div style="font-size: 10px; color: #666; margin-bottom: 5px; font-family: Consolas;">// zoom_config.json</div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 10px; color: #858585;">VIEW</span>
                        <input type="range" id="zoom-slider" min="6" max="12" step="0.5" value="12" 
                               oninput="updateZoom(this.value)"
                               style="flex: 1; cursor: pointer; accent-color: #007acc; height: 3px; background: #3c3c3c; border-radius: 2px; appearance: none;">
                    </div>
                </div>
            </div>
            <div class="sidebar-title"><span>ONLINE PLAYERS</span></div>
            <div id="live-list" class="sidebar-content"></div>
            <div class="sidebar-title"><span>LEADERBOARD</span></div>
            <div id="global-list" class="sidebar-content" style="max-height: 200px;"></div>
        </div>

        <div id="editor-group">
            <div id="tabs">
                <div class="tab">
                    <span style="color:#e8ba36; font-weight:bold; margin-right:5px;">JS</span> game.js <span style="margin-left:10px; font-size:10px">x</span>
                </div>
                <div class="tab" style="border-top-color: var(--purple); border-left: 1px solid #222;">
                    <span style="color:#e8ba36; font-weight:bold; margin-right:5px;">JS</span> 
                    <span id="timer-tab-text">timer_5:00.js</span>
                </div>
            </div>
            <div id="editor-container">
                <div id="gutter">1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12</div>
                <canvas id="gameCanvas"></canvas>
                <div id="toast-container"></div>
            </div>
            <div id="terminal-panel">
                <div id="terminal-tabs">
                    <span class="term-tab active">TERMINAL</span>
                </div>
                <div id="chat-history">
                    <div style="color: #6a9955">// Waiting for player connection...</div>
                </div>
                <div id="chat-input-line">
                    <span class="prompt">âžœ</span>
                    <input type="text" id="chat-input" placeholder="console.log('Mensagem...');">
                </div>
            </div>
        </div>

        <div id="right-sidebar">
            <div class="sidebar-title"><span>OUTPUT: ACTIVITY LOG</span> <span>...</span></div>
            <div id="activity-log" class="log-container">
                <div class="log-entry" style="border-left-color: var(--blue);">
                    <span class="time">[SYS]</span> <span style="color: var(--blue); font-weight: bold;">System</span> <span style="color: #cccccc;">Log engine initialized.</span>
                </div>
            </div>
        </div>

    </div>

    <div id="status-bar">
        <div style="display:flex; gap: 15px;">
            <div><span style="margin-right:5px">master*</span></div>
            <div>0 errors, 0 warnings</div>
        </div>
        <div style="display:flex; gap: 15px;">
            <div>Ln 12, Col 80</div>
            <div>Spaces: 4</div>
            <div>UTF-8</div>
            <div>JavaScript</div>
        </div>
    </div>

    <div id="login" class="modal">
        <h2 style="color: var(--blue); margin-top:0;">Initialize Session</h2>
        <input type="text" id="nick" class="login-input" placeholder="const username = ..." maxlength="10">
        <button class="btn-primary" onclick="join()">npm start</button>
    </div>
    <div id="game-over" class="modal">
        <h2 style="color: var(--red); margin-top:0;">Runtime Error</h2>
        <p style="color: #ccc; font-size: 13px;">Uncaught Exception: <span id="death-msg" style="color: var(--orange)">Process Terminated</span></p>
        <button class="btn-primary btn-danger" onclick="restartSession()">Restart Debugging</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="audio.js"></script> 
    <script src="game.js"></script>
    <script src="render.js"></script>
    <script src="input.js"></script> 
</body>
</html>